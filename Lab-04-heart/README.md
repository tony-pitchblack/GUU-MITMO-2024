# Лабораторная работа 4
## Вариант 17
*Набор данных:* default_of_credit_card_clients
*Независимые переменные:*
LIMIT_BAL, SEX, EDUCATION, MARRIAGE, AGE,
PAY_0, PAY_2, PAY_3,
BILL_AMT1, BILL_AMT2, BILL_AMT3
*Зависимая переменная:* Y (default)
*Метод снижения размерности:* PCR
*Метод регуляризации:* ridge

1. Данные были разделены на двe выборки: обучающую 85% и тестовую 15%

2. Результат предварительного анализа: доли классов по целевой переменной неравные - 0.8 для default=0, и 0.2 для default=1 

2. Результат корреляционного анализа:
    - сильно коррелированы BILL_AMT1, BILL_AMT2, BILL_AMT3;
    - средне коррелированы PAY_0, PAY_2, PAY_3.
    
3. На главных компонентах, полученных с помощью PCA на стандартизованных данных были построены две логистические регрессии - на первые 2 компоненты и на первые 5 компонент, объясняющих соответственно 50% и 80% дисперсии исходных переменных. Их точность, оцененная кроccвалидацией по 10 фолдам составила 0.798 и 0.804 соответственно.

4. На стандартизованных исходнных данных была построена ридж-регрессия. Оптимальное значение гиперпараметра веса штрафа $ \lambda $, найденное с помощью кроссвалидации по 10 фолдам составило 2.97. Точность модели с регуляризацией составила 0.81.

5. Наиболее точной оказалась модель с регуляризацией без учета неравенства классов. Показатели точности проноза Precision и Recall для класса default=0 оказались достаточно высокими, в то время как для класса default=1 модель показала низкий уровень полноты:
        
                 precision  recall  
           0       0.82      0.97    
           1       0.71      0.24

5. В задаче оценки платежеспособности клиентов доля ложноотрицательных прогнозов неплатежеспособных клиентов (класса default=1) является очень важным показателем и желательно его как-то улучшить. Была выдвинута гипотеза о том, что низкая полнота вызвана дисбалансом классов. Для устранения этого недостатка была построена альтернативная ридж-регрессия, учитывающая неравенство классов. Её точность на обучающей выборке после кроссвалидации по 10 фолдам оказалась равной 0.701, что немного ниже оригинальной регрессии. На прогнозных данных для класса default=0 немного ухудшилась полнота, при этом для класса default=1 часть точности была "конвертирована" в полноту:

                precision    recall  
           0       0.87      0.72      
           1       0.39      0.63     

**В итоге**  получены две модели с приемелемой точностью, по-разному приоритизирующие ложноположительные и ложноотрицательные прогнозы